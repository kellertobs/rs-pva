# rs-pva

Randomised Search Polytopic Vector Analysis: an algorithm to identify the optimal number, composition, and respective mixing proportions of endmembers to best fit a set of geochemical analyses.

The algorithm was developed by Tobias Keller, University of Glasgow, based on the work of Johnson et al. (2015). It was written and tested in Matlab R2019b.

To run the program, execute the script rs_pva.m in Matlab and follow the prompts on the command line. Three datasets are provided for testing purposes (type filename on first prompt): (1) DATA.mat, (2) BO16_MAJOR.csv, (3) RA16_MAJOR.csv. Dataset (1) is artifical data generated by the generate.m script (included in ./src); dataset (2) contains the major element analyses of Blum Oeste et al. (2016); dataset (3) contains major element analyses of Rawson et al. (2016).

**References**
Oeste, M., Wörner, G. (2016). Central Andean magmatism can be constrained by three ubiquitous end‐members. *Terra Nova*  28(6), 434-440. https://dx.doi.org/10.1111/ter.12237.

Johnson, G.W., Ehrlich, R., Full, W., Ramos, S., (2015). Principal Components Analysis and Receptor Models in Environmental Forensics. In: Murphy, B. L., Morrison, R.D. (Eds.), Introduction to Environmental Forensics, pp. 609?653. ISBN: 9780124046962.

Rawson, H., Keller, T., Fontijn, K., Pyle, D., Mather, T., Smith, V., Naranjo, J. (2016). Compositional variability in mafic arc magmas over short spatial and temporal scales: Evidence for the signature of mantle reactive melt channels. *Earth And Planetary Science Letters* 456, 66-77. https://dx.doi.org/10.1016/j.epsl.2016.09.056.
